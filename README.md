# ATC Training Radar

航空管制訓練を目的として設計されたWebベースのレーダーシミュレーターです。ユーザーはシミュレートされたレーダー環境で、航空機の生成、監視、および指示を行うことができます。

## 主な機能

- **航空機シミュレーション**: 航空機を生成し、指示を与えます。各航空機はユニークなコールサイン、針路、速度を持ち、その位置はリアルタイムで更新されます。
- **操作モード**:
  - **`生成`モード**: レーダー上の任意の点をクリックして新しい航空機をスポーンします。初期針路の指定も可能です。
  - **`指示`モード**: 航空機を選択し、針路指示（0-360°）を出します。航空機は標準旋回率で新しい針路に向かいます。
  - **`計測`モード**: クリック＆ドラッグで、レーダー上の2点間の距離（海里）と方位を計測します。
- **レーダーツールと表示**:
  - **シミュレーション速度**: シミュレーションの速度を調整できます（0.5x, 1x, 2x, 5x）。
  - **訓練用オーバーレイ**: 同心円のレンジリングやプロシージャ訓練用のカスタム図形など、さまざまなオーバーレイを表示します。
  - **PWA対応**: プログレッシブウェブアプリとしてインストールでき、ネイティブアプリのような体験やオフラインでの利用が可能です。

## 航空機の速度ロジック

航空機の速度は、その位置や状態に基づいて複数のルールによって動的に計算されます。優先順位の高いルールから順に適用されます。

**1. 最終進入 (最優先)**
最終進入コースにいる航空機は、中心からの距離に基づいて速度が精密に制御されます。
- **16海里 > 10海里**: 220ノットから200ノットへ徐々に減速
- **10海里 > 8海里**: 200ノットから170ノットへ徐々に減速
- **8海里 > 0海里**: 170ノットから130ノットへ徐々に減速

**2. バウムクーヘン・セクター (方位150°～210°の南側エリア)**
南側の特定エリア（バウムクーヘン・セクター）を飛行中の航空機は、以下の速度に制御されます。
- **25海里地点（南ライン）より内側**: 240ノット
- **20海里地点（北ライン）より内側**: 220ノット

**3. 通常速度ルール**
上記以外のエリアを飛行する航空機は、中心からの距離に応じて以下の速度で飛行します。
- **50海里より外側**: 300ノット
- **50海里～40海里**: 280ノット
- **40海里～30海里**: 270ノット
- **30海里～20海里**: 260ノットから240ノットへ徐々に減速

**4. フォールバック**
上記ルールに該当しない場合（例: 20海里以内で最終進入やバウムクーヘン・セクター外）、速度は **220ノット** になります。

## 使い方

1.  **モード選択**: 上部バーから`生成`、`指示`、`計測`のいずれかのモードを選択します。
2.  **航空機の生成**: `生成`モードで、レーダー上をクリックします。右側のコントロールパネルにある「生成HDG」入力欄で初期針路を設定できます。
3.  **指示の発行**: `指示`モードで、航空機をクリックして選択します。コントロールパネルのテンキーで針路を入力し、「指示」ボタンを押します。
4.  **計測**: `計測`モードで、レーダー上をドラッグして距離と方位を計測します。

## 技術スタック

このプロジェクトは、最新のシンプルなウェブ技術スタックで構築されています。

-   **フロントエンド**: [React](https://react.dev/) と [TypeScript](https://www.typescriptlang.org/)
-   **ビルドツール**: [Vite](https://vitejs.dev/)
-   **状態管理**: Reactの組み込みフック (`useState`, `useContext`, `useReducer`) を使用し、すべてのアプリケーションロジックを一元化するカスタム `useRadarState` フックにカプセル化されています。
-   **レンダリング**: HTML5 Canvas API を使用して、レーダー表示を効率的かつ動的にレンダリングします。

## 開発

### セットアップ

依存関係をインストールします:
```bash
npm install
```

### 開発サーバーの実行

開発サーバーを起動するには、以下を実行します:
```bash
npm run dev
```
これにより、通常 `http://localhost:5173` でブラウザにアプリケーションが開きます。

### プロダクションビルド

プロダクションビルドを作成するには、以下を実行します:
```bash
npm run build
```
出力ファイルは `dist` ディレクトリに生成されます。

## デプロイ

このプロジェクトはGitHub Pagesに自動的にデプロイされます。`main`ブランチへのプッシュのうち、コミットメッセージが `feat:` または `refactor:` で始まるものをトリガーとして、ワークフローが実行されます。